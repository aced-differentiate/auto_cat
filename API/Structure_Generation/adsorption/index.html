
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>autocat.adsorption - AutoCat Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#autocat.adsorption" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AutoCat Documentation" class="md-header__button md-logo" aria-label="AutoCat Documentation" data-md-component="logo">
      
  <img src="../../../img/autocat_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AutoCat Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              autocat.adsorption
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aced-differentiate/auto_cat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../User_Guide/Learning/featurizers/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Tutorials/pred_h/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../Learning/featurizers/" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AutoCat Documentation" class="md-nav__button md-logo" aria-label="AutoCat Documentation" data-md-component="logo">
      
  <img src="../../../img/autocat_icon.png" alt="logo">

    </a>
    AutoCat Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aced-differentiate/auto_cat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Sequential Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sequential Learning" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Sequential Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Learning/featurizers/" class="md-nav__link">
        Featurizers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Learning/predictors/" class="md-nav__link">
        Predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Learning/sequential/" class="md-nav__link">
        Sequential
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Structure Generation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Structure Generation" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Structure Generation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Structure_Generation/bulk/" class="md-nav__link">
        Bulk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Structure_Generation/surface/" class="md-nav__link">
        Surfaces
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Structure_Generation/adsorption/" class="md-nav__link">
        Adsorption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Structure_Generation/saa/" class="md-nav__link">
        Single Atom Alloys
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Data/hhi/" class="md-nav__link">
        HHI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Data/segregation_energies/" class="md-nav__link">
        Segregation Energies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Data/lattice_parameters/" class="md-nav__link">
        Lattice Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../User_Guide/Data/intermediates/" class="md-nav__link">
        Reaction Intermediates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/pred_h/" class="md-nav__link">
        Training a Predictor on hydrogen adsorption energies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tutorials/sl/" class="md-nav__link">
        Conducting a simulated sequential learning run
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Sequential Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sequential Learning" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Sequential Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Learning/featurizers/" class="md-nav__link">
        autocat.learning.featurizers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Learning/predictors/" class="md-nav__link">
        autocat.learning.predictors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Learning/sequential/" class="md-nav__link">
        autocat.learning.sequential
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Structure Generation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Structure Generation" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Structure Generation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bulk/" class="md-nav__link">
        autocat.bulk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../surface/" class="md-nav__link">
        autocat.surface
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          autocat.adsorption
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        autocat.adsorption
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption" class="md-nav__link">
    autocat.adsorption
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption.generate_adsorbed_structures" class="md-nav__link">
    generate_adsorbed_structures()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption.generate_molecule" class="md-nav__link">
    generate_molecule()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption.get_adsorbate_height_estimate" class="md-nav__link">
    get_adsorbate_height_estimate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption.get_adsorbate_slab_nn_list" class="md-nav__link">
    get_adsorbate_slab_nn_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption.get_adsorption_sites" class="md-nav__link">
    get_adsorption_sites()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autocat.adsorption.place_adsorbate" class="md-nav__link">
    place_adsorbate()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../saa/" class="md-nav__link">
        autocat.saa
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/aced-differentiate/auto_cat/edit/master/docs/API/Structure_Generation/adsorption.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>autocat.adsorption</h1>

<div class="doc doc-object doc-module">


<a id="autocat.adsorption"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="autocat.adsorption.generate_adsorbed_structures" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_adsorbed_structures</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorbates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorption_sites</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_all_sites</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">site_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor_atom_indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_to_disk</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_location</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Builds structures for reaction intermediates by placing the adsorbate moeity
on the input surface at specified positions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>surface</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="ase.Atoms">Atoms</span>]</code>
          </td>
          <td><p>Atoms object or path to a file on disk containing the structure of the
host surface.
Note that the format of the file must be readable with <code>ase.io</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>adsorbates (REQUIRED):
    Dictionary of adsorbate molecule/intermediate names and corresponding
    <code>ase.Atoms</code> object or string to be placed on the host surface.</p>
<div class="highlight"><pre><span></span><code>Note that the strings that appear as values must be in the list of
supported molecules in `autocat.data.intermediates` or in the `ase` g2
database. Predefined data in `autocat.data` will take priority over that
in `ase`.

Alternatively, a list of strings can be provided as input.
Note that each string has to be *unique* and available in
`autocat.data.intermediates` or the `ase` g2 database.

Example:
{
    &quot;NH&quot;: &quot;NH&quot;,
    &quot;N*&quot;: &quot;N&quot;,
    &quot;NNH&quot;: NNH_atoms_obj,
    ...
}

OR

[&quot;NH&quot;, &quot;NNH&quot;]
</code></pre></div>
<p>rotations:
    Dictionary of the list of rotation operations to be applied to each
    adsorbate molecule/intermediate before being placed on the host surface.
    Alternatively, a single list of rotation operations can be provided as
    input to be used for all adsorbates.</p>
<div class="highlight"><pre><span></span><code>Rotating 90 degrees around the z axis followed by 45 degrees
around the y-axis can be specified as
    [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)]

Example:
{
    &quot;NH&quot;: [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)],
    &quot;NNH&quot;: ...
}

Defaults to [(0, &quot;x&quot;)] (i.e., no rotations applied) for each adsorbate
molecule.
</code></pre></div>
<p>adsorption_sites:
    Dictionary with labels + list of xy coordinates of sites on the surface
    where each adsorbate must be placed.
    Alternatively, a single dictionary with label and a list of xy
    coordinates can be provided as input to be used for all adsorbates.</p>
<div class="highlight"><pre><span></span><code>Example:
{
    &quot;NH&quot;: {
        &quot;my_awesome_site_1&quot;: [(0.0, 0.0), (0.25, 0.25)],
        &quot;my_awesome_site_2&quot;: [(0.0, 1.5)],
        ...
    },
    &quot;NNH&quot;: ...
}

OR

{
    &quot;my_default_site&quot;: [(0.5, 0.5)],
}

Defaults to {&quot;origin&quot;: [(0, 0)]} for all adsorbates.
</code></pre></div>
<p>use_all_sites:
    Dictionary specifying if all symmetrically unique sites on the surface
    must be used for placing each adsorbate. Will generate a number of
    adsorbed structures equal to the number of symmetrically unique sites
    identified using the <code>AdsorbateSiteFinder</code> module from <code>pymatgen</code>.
    Alternatively, a single Boolean value can be provided as input to be
    used for all adsorbates.</p>
<div class="highlight"><pre><span></span><code>NB: If True, overrides any sites defined in `adsorption_sites` for each
adsorbate.

Defaults to False for all adsorbates.
</code></pre></div>
<p>site_types:
    Dictionary of the types of adsorption sites to be searched for for each
    adsorbate. Options are "ontop", "bridge", and "hollow".
    Alternatively, a single list of adsorption sites can be provided as
    input to be used for all adsorbates.
    Ignored if <code>use_all_sites</code> is False.</p>
<div class="highlight"><pre><span></span><code>Defaults to [&quot;ontop&quot;, &quot;bridge&quot;, &quot;hollow&quot;] (if `use_all_sites` is True)
for all adsorbates.
</code></pre></div>
<p>heights:
    Dictionary of the height above surface where each adsorbate should be
    placed.
    Alternatively, a single float value can be provided as input to be
    used for all adsorbates.
    If None, will estimate initial height based on covalent radii of the
    nearest neighbor atoms for each adsorbate.</p>
<p>anchor_atom_indices:
    Dictionary of the integer index of the atom in each adsorbate molecule
    that should be used as anchor when placing it on the surface.
    Alternatively, a single integer index can be provided as input to be
    used for all adsorbates.
    Defaults to the atom at index 0 for each adsorbate molecule.</p>
<p>write_to_disk:
    Boolean specifying whether the bulk structures generated should be
    written to disk.
    Defaults to False.</p>
<p>write_location:
    String with the location where the per-species/per-crystal structure
    directories must be constructed and structure files written to disk.
    In the specified write_location, the following directory structure
    will be created:</p>
<div class="highlight"><pre><span></span><code>adsorbates/[adsorbate_1]/[site_label_1]/[xy_site_coord_1]/input.traj
adsorbates/[adsorbate_1]/[site_label_1]/[xy_site_coord_2]/input.traj
...
adsorbates/[adsorbate_1]/[site_label_2]/[xy_site_coord_1]/input.traj
...
adsorbates/[adsorbate_2]/[site_label_1]/[xy_site_coord_1]/input.traj
...
</code></pre></div>
<p>dirs_exist_ok:
    Boolean specifying whether existing directories/files should be
    overwritten or not. This is passed on to the <code>os.makedirs</code> builtin.
    Defaults to False (raises an error if directories corresponding the
    species and crystal structure already exist).</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>ads_structures</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Dict">Dict</span>[str, <span title="typing.Dict">Dict</span>[str, <span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]]]</code>
          </td>
          <td><p>Dictionary containing all of the reaction structures (with the input
molecule/intermediate adsorbed onto the surface) as <code>ase.Atoms</code> object
for all adsorbates and adsorption sites.</p>
<p>Example:</p>
<p>{
"NH": {
"ontop": {
"5.345_2.342": {
"structure": NH_on_surface_obj,
"traj_file_path": "/path/to/NH/adsorbed/on/surface/traj/file"
},
"1.478_1.230": {
...
},
},
"hollow": {
...
},
...
"NNH": {
...
}
}</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>autocat/adsorption.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_adsorbed_structures</span><span class="p">(</span>
    <span class="n">surface</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adsorbates</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">]],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adsorption_sites</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AdsorptionSite</span><span class="p">],</span> <span class="n">AdsorptionSite</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_all_sites</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">site_types</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">heights</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">anchor_atom_indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rotations</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RotationOperations</span><span class="p">],</span> <span class="n">RotationOperations</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_to_disk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">write_location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">dirs_exist_ok</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Builds structures for reaction intermediates by placing the adsorbate moeity</span>
<span class="sd">    on the input surface at specified positions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    surface (REQUIRED):</span>
<span class="sd">        Atoms object or path to a file on disk containing the structure of the</span>
<span class="sd">        host surface.</span>
<span class="sd">        Note that the format of the file must be readable with `ase.io`.</span>

<span class="sd">    adsorbates (REQUIRED):</span>
<span class="sd">        Dictionary of adsorbate molecule/intermediate names and corresponding</span>
<span class="sd">        `ase.Atoms` object or string to be placed on the host surface.</span>

<span class="sd">        Note that the strings that appear as values must be in the list of</span>
<span class="sd">        supported molecules in `autocat.data.intermediates` or in the `ase` g2</span>
<span class="sd">        database. Predefined data in `autocat.data` will take priority over that</span>
<span class="sd">        in `ase`.</span>

<span class="sd">        Alternatively, a list of strings can be provided as input.</span>
<span class="sd">        Note that each string has to be *unique* and available in</span>
<span class="sd">        `autocat.data.intermediates` or the `ase` g2 database.</span>

<span class="sd">        Example:</span>
<span class="sd">        {</span>
<span class="sd">            &quot;NH&quot;: &quot;NH&quot;,</span>
<span class="sd">            &quot;N*&quot;: &quot;N&quot;,</span>
<span class="sd">            &quot;NNH&quot;: NNH_atoms_obj,</span>
<span class="sd">            ...</span>
<span class="sd">        }</span>

<span class="sd">        OR</span>

<span class="sd">        [&quot;NH&quot;, &quot;NNH&quot;]</span>

<span class="sd">    rotations:</span>
<span class="sd">        Dictionary of the list of rotation operations to be applied to each</span>
<span class="sd">        adsorbate molecule/intermediate before being placed on the host surface.</span>
<span class="sd">        Alternatively, a single list of rotation operations can be provided as</span>
<span class="sd">        input to be used for all adsorbates.</span>

<span class="sd">        Rotating 90 degrees around the z axis followed by 45 degrees</span>
<span class="sd">        around the y-axis can be specified as</span>
<span class="sd">            [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)]</span>

<span class="sd">        Example:</span>
<span class="sd">        {</span>
<span class="sd">            &quot;NH&quot;: [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)],</span>
<span class="sd">            &quot;NNH&quot;: ...</span>
<span class="sd">        }</span>

<span class="sd">        Defaults to [(0, &quot;x&quot;)] (i.e., no rotations applied) for each adsorbate</span>
<span class="sd">        molecule.</span>

<span class="sd">    adsorption_sites:</span>
<span class="sd">        Dictionary with labels + list of xy coordinates of sites on the surface</span>
<span class="sd">        where each adsorbate must be placed.</span>
<span class="sd">        Alternatively, a single dictionary with label and a list of xy</span>
<span class="sd">        coordinates can be provided as input to be used for all adsorbates.</span>

<span class="sd">        Example:</span>
<span class="sd">        {</span>
<span class="sd">            &quot;NH&quot;: {</span>
<span class="sd">                &quot;my_awesome_site_1&quot;: [(0.0, 0.0), (0.25, 0.25)],</span>
<span class="sd">                &quot;my_awesome_site_2&quot;: [(0.0, 1.5)],</span>
<span class="sd">                ...</span>
<span class="sd">            },</span>
<span class="sd">            &quot;NNH&quot;: ...</span>
<span class="sd">        }</span>

<span class="sd">        OR</span>

<span class="sd">        {</span>
<span class="sd">            &quot;my_default_site&quot;: [(0.5, 0.5)],</span>
<span class="sd">        }</span>

<span class="sd">        Defaults to {&quot;origin&quot;: [(0, 0)]} for all adsorbates.</span>

<span class="sd">    use_all_sites:</span>
<span class="sd">        Dictionary specifying if all symmetrically unique sites on the surface</span>
<span class="sd">        must be used for placing each adsorbate. Will generate a number of</span>
<span class="sd">        adsorbed structures equal to the number of symmetrically unique sites</span>
<span class="sd">        identified using the `AdsorbateSiteFinder` module from `pymatgen`.</span>
<span class="sd">        Alternatively, a single Boolean value can be provided as input to be</span>
<span class="sd">        used for all adsorbates.</span>

<span class="sd">        NB: If True, overrides any sites defined in `adsorption_sites` for each</span>
<span class="sd">        adsorbate.</span>

<span class="sd">        Defaults to False for all adsorbates.</span>

<span class="sd">    site_types:</span>
<span class="sd">        Dictionary of the types of adsorption sites to be searched for for each</span>
<span class="sd">        adsorbate. Options are &quot;ontop&quot;, &quot;bridge&quot;, and &quot;hollow&quot;.</span>
<span class="sd">        Alternatively, a single list of adsorption sites can be provided as</span>
<span class="sd">        input to be used for all adsorbates.</span>
<span class="sd">        Ignored if `use_all_sites` is False.</span>

<span class="sd">        Defaults to [&quot;ontop&quot;, &quot;bridge&quot;, &quot;hollow&quot;] (if `use_all_sites` is True)</span>
<span class="sd">        for all adsorbates.</span>

<span class="sd">    heights:</span>
<span class="sd">        Dictionary of the height above surface where each adsorbate should be</span>
<span class="sd">        placed.</span>
<span class="sd">        Alternatively, a single float value can be provided as input to be</span>
<span class="sd">        used for all adsorbates.</span>
<span class="sd">        If None, will estimate initial height based on covalent radii of the</span>
<span class="sd">        nearest neighbor atoms for each adsorbate.</span>

<span class="sd">    anchor_atom_indices:</span>
<span class="sd">        Dictionary of the integer index of the atom in each adsorbate molecule</span>
<span class="sd">        that should be used as anchor when placing it on the surface.</span>
<span class="sd">        Alternatively, a single integer index can be provided as input to be</span>
<span class="sd">        used for all adsorbates.</span>
<span class="sd">        Defaults to the atom at index 0 for each adsorbate molecule.</span>

<span class="sd">    write_to_disk:</span>
<span class="sd">        Boolean specifying whether the bulk structures generated should be</span>
<span class="sd">        written to disk.</span>
<span class="sd">        Defaults to False.</span>

<span class="sd">    write_location:</span>
<span class="sd">        String with the location where the per-species/per-crystal structure</span>
<span class="sd">        directories must be constructed and structure files written to disk.</span>
<span class="sd">        In the specified write_location, the following directory structure</span>
<span class="sd">        will be created:</span>

<span class="sd">        adsorbates/[adsorbate_1]/[site_label_1]/[xy_site_coord_1]/input.traj</span>
<span class="sd">        adsorbates/[adsorbate_1]/[site_label_1]/[xy_site_coord_2]/input.traj</span>
<span class="sd">        ...</span>
<span class="sd">        adsorbates/[adsorbate_1]/[site_label_2]/[xy_site_coord_1]/input.traj</span>
<span class="sd">        ...</span>
<span class="sd">        adsorbates/[adsorbate_2]/[site_label_1]/[xy_site_coord_1]/input.traj</span>
<span class="sd">        ...</span>

<span class="sd">    dirs_exist_ok:</span>
<span class="sd">        Boolean specifying whether existing directories/files should be</span>
<span class="sd">        overwritten or not. This is passed on to the `os.makedirs` builtin.</span>
<span class="sd">        Defaults to False (raises an error if directories corresponding the</span>
<span class="sd">        species and crystal structure already exist).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    ads_structures:</span>
<span class="sd">        Dictionary containing all of the reaction structures (with the input</span>
<span class="sd">        molecule/intermediate adsorbed onto the surface) as `ase.Atoms` object</span>
<span class="sd">        for all adsorbates and adsorption sites.</span>

<span class="sd">        Example:</span>

<span class="sd">        {</span>
<span class="sd">            &quot;NH&quot;: {</span>
<span class="sd">                &quot;ontop&quot;: {</span>
<span class="sd">                    &quot;5.345_2.342&quot;: {</span>
<span class="sd">                        &quot;structure&quot;: NH_on_surface_obj,</span>
<span class="sd">                        &quot;traj_file_path&quot;: &quot;/path/to/NH/adsorbed/on/surface/traj/file&quot;</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;1.478_1.230&quot;: {</span>
<span class="sd">                        ...</span>
<span class="sd">                    },</span>
<span class="sd">                },</span>
<span class="sd">                &quot;hollow&quot;: {</span>
<span class="sd">                    ...</span>
<span class="sd">                },</span>
<span class="sd">                ...</span>
<span class="sd">            &quot;NNH&quot;: {</span>
<span class="sd">                ...</span>
<span class="sd">            }</span>
<span class="sd">        }</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">surface</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Surface structure must be specified&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">surface</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for surface (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Input wrangling for the different types of parameter values allowed for</span>
    <span class="c1"># the same function arguments.</span>

    <span class="k">if</span> <span class="n">adsorbates</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">adsorbates</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Adsorbate molecules/intermediates must be specified&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adsorbates</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">adsorbates</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">ads_key</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adsorbates</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for adsorbates (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">adsorbates</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rotations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rotations</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">rotations</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">rotations</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rotations</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for rotations (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">rotations</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">adsorption_sites</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">adsorption_sites</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adsorption_sites</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="c1"># check if the input is a single site for all adsorbates vs separate</span>
        <span class="c1"># sites for each adsorbate</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">ads_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">adsorption_sites</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">]):</span>
            <span class="n">adsorption_sites</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">adsorption_sites</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adsorption_sites</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for adsorption_sites (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">adsorption_sites</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_all_sites</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">use_all_sites</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_all_sites</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">use_all_sites</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">use_all_sites</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_all_sites</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for use_all_sites (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">use_all_sites</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">site_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">site_types</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">site_types</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">site_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">site_types</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">site_types</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for site_types (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">site_types</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">heights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">heights</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">heights</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">heights</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for heights (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">anchor_atom_indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">anchor_atom_indices</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anchor_atom_indices</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">anchor_atom_indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">ads_key</span><span class="p">:</span> <span class="n">anchor_atom_indices</span> <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">}</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anchor_atom_indices</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unrecognized input type for anchor_atom_indices (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">anchor_atom_indices</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">ads_structures</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ads_key</span> <span class="ow">in</span> <span class="n">adsorbates</span><span class="p">:</span>
        <span class="n">ads_structures</span><span class="p">[</span><span class="n">ads_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># generate the molecule if not already input</span>
        <span class="n">adsorbate</span> <span class="o">=</span> <span class="n">adsorbates</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">adsorbate</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">adsorbate</span> <span class="o">=</span> <span class="n">generate_molecule</span><span class="p">(</span><span class="n">molecule_name</span><span class="o">=</span><span class="n">adsorbate</span><span class="p">)[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
        <span class="c1"># get all adsorption sites for the adsorbate</span>
        <span class="n">ads_adsorption_sites</span> <span class="o">=</span> <span class="n">adsorption_sites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]})</span>
        <span class="n">ads_use_all_sites</span> <span class="o">=</span> <span class="n">use_all_sites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ads_use_all_sites</span><span class="p">:</span>
            <span class="n">ads_site_types</span> <span class="o">=</span> <span class="n">site_types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ontop&quot;</span><span class="p">,</span> <span class="s2">&quot;bridge&quot;</span><span class="p">,</span> <span class="s2">&quot;hollow&quot;</span><span class="p">])</span>
            <span class="n">ads_adsorption_sites</span> <span class="o">=</span> <span class="n">get_adsorption_sites</span><span class="p">(</span>
                <span class="n">surface</span><span class="p">,</span> <span class="n">site_types</span><span class="o">=</span><span class="n">ads_site_types</span>
            <span class="p">)</span>
        <span class="c1"># for each adsorption site type, for each (xy) coordinate, generate the</span>
        <span class="c1"># adsorbated (surface + adsorbate) structure</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">ads_adsorption_sites</span><span class="p">:</span>
            <span class="n">ads_structures</span><span class="p">[</span><span class="n">ads_key</span><span class="p">][</span><span class="n">site</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">coords</span> <span class="ow">in</span> <span class="n">ads_adsorption_sites</span><span class="p">[</span><span class="n">site</span><span class="p">]:</span>
                <span class="c1"># use only xy coords and ignore z if given here (handled by ads_height)</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">rcoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                <span class="n">scoords</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">rcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">rcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">ads_height</span> <span class="o">=</span> <span class="n">heights</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">ads_anchor_atom_index</span> <span class="o">=</span> <span class="n">anchor_atom_indices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">ads_rotations</span> <span class="o">=</span> <span class="n">rotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads_key</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)])</span>
                <span class="n">adsorbed_structure</span> <span class="o">=</span> <span class="n">place_adsorbate</span><span class="p">(</span>
                    <span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">,</span>
                    <span class="n">adsorbate</span><span class="o">=</span><span class="n">adsorbate</span><span class="p">,</span>
                    <span class="n">adsorption_site</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
                    <span class="n">anchor_atom_index</span><span class="o">=</span><span class="n">ads_anchor_atom_index</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="n">ads_height</span><span class="p">,</span>
                    <span class="n">rotations</span><span class="o">=</span><span class="n">ads_rotations</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">traj_file_path</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">write_to_disk</span><span class="p">:</span>
                    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">write_location</span><span class="p">,</span> <span class="s2">&quot;adsorbates&quot;</span><span class="p">,</span> <span class="n">ads_key</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">scoords</span>
                    <span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="n">dirs_exist_ok</span><span class="p">)</span>
                    <span class="n">traj_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;input.traj&quot;</span><span class="p">)</span>
                    <span class="n">adsorbed_structure</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">traj_file_path</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Structure with </span><span class="si">{</span><span class="n">ads_key</span><span class="si">}</span><span class="s2"> adsorbed at </span><span class="si">{</span><span class="n">site</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">scoords</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot; written to </span><span class="si">{</span><span class="n">traj_file_path</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="n">ads_structures</span><span class="p">[</span><span class="n">ads_key</span><span class="p">][</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="n">scoords</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;structure&quot;</span><span class="p">:</span> <span class="n">adsorbed_structure</span><span class="p">,</span>
                            <span class="s2">&quot;traj_file_path&quot;</span><span class="p">:</span> <span class="n">traj_file_path</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">ads_structures</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="autocat.adsorption.generate_molecule" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_molecule</span><span class="p">(</span><span class="n">molecule_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_to_disk</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_location</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates an <code>ase.Atoms</code> object of an isolated molecule.
If specified, can write out a .traj file containing the isolated molecule
in a box.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>molecule_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>String of the name of the molecule to be generated. Will search in
<code>autocat.intermediates</code> data first and then <code>ase</code> g2 database.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>rotations:
    List of rotation operations to be applied to the adsorbate
    molecule/intermediate before being placed on the host surface.</p>
<div class="highlight"><pre><span></span><code>Example:
Rotating 90 degrees around the z axis followed by 45 degrees
around the y-axis can be specified as
    [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)]

Defaults to [(0, &quot;x&quot;)] (i.e., no rotations applied).
</code></pre></div>
<p>cell:
    List of float specifying the dimensions of the box to place the molecule
    in, in Angstrom.
    Defaults to [15, 15, 15].</p>
<p>write_to_disk:
    Boolean specifying whether the bulk structures generated should be
    written to disk.
    Defaults to False.</p>
<p>write_location:
    String with the location where the molecule structure must be written.
    The molecule is written to disk at
    [write_location]/references/[molecule_name]/input.traj</p>
<p>dirs_exist_ok:
    Boolean specifying whether existing directories/files should be
    overwritten or not. This is passed on to the <code>os.makedirs</code> builtin.
    Defaults to False (raises an error if directories corresponding the
    species and crystal structure already exist).</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Dictionary containing Atoms object of the generated molecule and path to</code>
          </td>
          <td></td>
        </tr>
        <tr>
          <td>
                <code>.traj file if written to disk.</code>
          </td>
          <td></td>
        </tr>
    </tbody>
  </table>
      <p>Example:
{
    "NH": {"structure": NH_ase_obj, "traj_file_path": "/path/to/NH/traj/file"},
}</p>

      <details class="quote">
        <summary>Source code in <code>autocat/adsorption.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_molecule</span><span class="p">(</span>
    <span class="n">molecule_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rotations</span><span class="p">:</span> <span class="n">RotationOperations</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cell</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_to_disk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">write_location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">dirs_exist_ok</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates an `ase.Atoms` object of an isolated molecule.</span>
<span class="sd">    If specified, can write out a .traj file containing the isolated molecule</span>
<span class="sd">    in a box.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    molecule_name (REQUIRED):</span>
<span class="sd">        String of the name of the molecule to be generated. Will search in</span>
<span class="sd">        `autocat.intermediates` data first and then `ase` g2 database.</span>

<span class="sd">    rotations:</span>
<span class="sd">        List of rotation operations to be applied to the adsorbate</span>
<span class="sd">        molecule/intermediate before being placed on the host surface.</span>

<span class="sd">        Example:</span>
<span class="sd">        Rotating 90 degrees around the z axis followed by 45 degrees</span>
<span class="sd">        around the y-axis can be specified as</span>
<span class="sd">            [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)]</span>

<span class="sd">        Defaults to [(0, &quot;x&quot;)] (i.e., no rotations applied).</span>

<span class="sd">    cell:</span>
<span class="sd">        List of float specifying the dimensions of the box to place the molecule</span>
<span class="sd">        in, in Angstrom.</span>
<span class="sd">        Defaults to [15, 15, 15].</span>

<span class="sd">    write_to_disk:</span>
<span class="sd">        Boolean specifying whether the bulk structures generated should be</span>
<span class="sd">        written to disk.</span>
<span class="sd">        Defaults to False.</span>

<span class="sd">    write_location:</span>
<span class="sd">        String with the location where the molecule structure must be written.</span>
<span class="sd">        The molecule is written to disk at</span>
<span class="sd">        [write_location]/references/[molecule_name]/input.traj</span>

<span class="sd">    dirs_exist_ok:</span>
<span class="sd">        Boolean specifying whether existing directories/files should be</span>
<span class="sd">        overwritten or not. This is passed on to the `os.makedirs` builtin.</span>
<span class="sd">        Defaults to False (raises an error if directories corresponding the</span>
<span class="sd">        species and crystal structure already exist).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Dictionary containing Atoms object of the generated molecule and path to</span>
<span class="sd">    .traj file if written to disk.</span>

<span class="sd">    Example:</span>
<span class="sd">    {</span>
<span class="sd">        &quot;NH&quot;: {&quot;structure&quot;: NH_ase_obj, &quot;traj_file_path&quot;: &quot;/path/to/NH/traj/file&quot;},</span>
<span class="sd">    }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">molecule_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Molecule name must be specified&quot;</span>
        <span class="k">raise</span> <span class="n">AutocatAdsorptionGenerationError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rotations</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>

    <span class="n">m</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">molecule_name</span> <span class="ow">in</span> <span class="n">NRR_MOLS</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">NRR_MOLS</span><span class="p">[</span><span class="n">molecule_name</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">molecule_name</span> <span class="ow">in</span> <span class="n">ORR_MOLS</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">ORR_MOLS</span><span class="p">[</span><span class="n">molecule_name</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">molecule_name</span> <span class="ow">in</span> <span class="n">chemical_symbols</span><span class="p">:</span>  <span class="c1"># atom-in-a-box</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="n">molecule_name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">molecule_name</span> <span class="ow">in</span> <span class="n">g2</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">build_molecule</span><span class="p">(</span><span class="n">molecule_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unable to construct molecule </span><span class="si">{</span><span class="n">molecule_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rotations</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">m</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">cell</span>

    <span class="n">m</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>

    <span class="n">traj_file_path</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">write_to_disk</span><span class="p">:</span>
        <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">write_location</span><span class="p">,</span> <span class="s2">&quot;references&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">molecule_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="n">dirs_exist_ok</span><span class="p">)</span>
        <span class="n">traj_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;input.traj&quot;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">traj_file_path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">molecule_name</span><span class="si">}</span><span class="s2"> molecule structure written to </span><span class="si">{</span><span class="n">traj_file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;structure&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">,</span> <span class="s2">&quot;traj_file_path&quot;</span><span class="p">:</span> <span class="n">traj_file_path</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="autocat.adsorption.get_adsorbate_height_estimate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_adsorbate_height_estimate</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorbate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorption_site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor_atom_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Guess an initial height for the adsorbate to be placed on the surface, by
summing covalent radii of the nearest neighbor atoms.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>surface</code></td>
          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p><code>ase.Atoms</code> object the surface for which adsorbate height must be estimated.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>adsorbate (REQUIRED):
    <code>ase.Atoms</code> object of adsorbate to be placed on the surface.</p>
<p>adsorption_site:
    Tuple or list of the xy cartesian coordinates for where the adsorbate
    would be placed.</p>
<div class="highlight"><pre><span></span><code>Defaults to [0, 0].
</code></pre></div>
<p>anchor_atom_index:
    Integer index of the atom in the adsorbate molecule that will be used as
    anchor when placing it on the surface.
    Defaults to the atom at index 0.</p>
<p>scale:
    Float giving a scale factor to be applied to the calculated bond length.
    For example, scale = 1.1 -&gt; bond length = 1.1 * (covalent_radius_1 + covalent_radius_2)
    Defaults to 1.0 (i.e., no scaling).</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>height_estimate</code></td>          <td>
                <code>float</code>
          </td>
          <td><p>Float with the estimated initial height for the adsorbate molecule from
the surface.
Returns a default of 1.5 Angstom if the guessing process using
nearest-neighbor covalent radii fails.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>autocat/adsorption.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_adsorbate_height_estimate</span><span class="p">(</span>
    <span class="n">surface</span><span class="p">:</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adsorbate</span><span class="p">:</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adsorption_site</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">anchor_atom_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Guess an initial height for the adsorbate to be placed on the surface, by</span>
<span class="sd">    summing covalent radii of the nearest neighbor atoms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    surface (REQUIRED):</span>
<span class="sd">        `ase.Atoms` object the surface for which adsorbate height must be estimated.</span>

<span class="sd">    adsorbate (REQUIRED):</span>
<span class="sd">        `ase.Atoms` object of adsorbate to be placed on the surface.</span>

<span class="sd">    adsorption_site:</span>
<span class="sd">        Tuple or list of the xy cartesian coordinates for where the adsorbate</span>
<span class="sd">        would be placed.</span>

<span class="sd">        Defaults to [0, 0].</span>

<span class="sd">    anchor_atom_index:</span>
<span class="sd">        Integer index of the atom in the adsorbate molecule that will be used as</span>
<span class="sd">        anchor when placing it on the surface.</span>
<span class="sd">        Defaults to the atom at index 0.</span>

<span class="sd">    scale:</span>
<span class="sd">        Float giving a scale factor to be applied to the calculated bond length.</span>
<span class="sd">        For example, scale = 1.1 -&gt; bond length = 1.1 * (covalent_radius_1 + covalent_radius_2)</span>
<span class="sd">        Defaults to 1.0 (i.e., no scaling).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    height_estimate:</span>
<span class="sd">        Float with the estimated initial height for the adsorbate molecule from</span>
<span class="sd">        the surface.</span>
<span class="sd">        Returns a default of 1.5 Angstom if the guessing process using</span>
<span class="sd">        nearest-neighbor covalent radii fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">adsorption_site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">adsorption_site</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">species</span><span class="p">,</span> <span class="n">coords</span> <span class="o">=</span> <span class="n">get_adsorbate_slab_nn_list</span><span class="p">(</span>
        <span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">,</span> <span class="n">adsorption_site</span><span class="o">=</span><span class="n">adsorption_site</span>
    <span class="p">)</span>
    <span class="n">ads_atom_radius</span> <span class="o">=</span> <span class="n">covalent_radii</span><span class="p">[</span>
        <span class="n">atomic_numbers</span><span class="p">[</span><span class="n">adsorbate</span><span class="p">[</span><span class="n">anchor_atom_index</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">guessed_heights</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sp</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
        <span class="n">nn_radius</span> <span class="o">=</span> <span class="n">covalent_radii</span><span class="p">[</span><span class="n">atomic_numbers</span><span class="p">[</span><span class="n">sp</span><span class="p">]]</span>
        <span class="n">r_dist</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="p">(</span><span class="n">ads_atom_radius</span> <span class="o">+</span> <span class="n">nn_radius</span><span class="p">)</span>
        <span class="n">position_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">adsorption_site</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r_dist</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">position_array</span> <span class="o">-</span> <span class="n">coord</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_dist</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">position_array</span> <span class="o">-</span> <span class="n">coord</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">guessed_heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">guessed_heights</span><span class="p">)):</span>
        <span class="n">height_estimate</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">height_estimate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">guessed_heights</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">height_estimate</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="autocat.adsorption.get_adsorbate_slab_nn_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_adsorbate_slab_nn_list</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorption_site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get list of nearest neighbors for the adsorbate on the surface at the
specified position.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>surface</code></td>
          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p>Atoms object the surface for which nearest neighbors of the adsorbate
should be identified.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>adsorption_site:
    Tuple or list of the xy cartesian coordinates for where the adsorbate
    would be placed.</p>
<div class="highlight"><pre><span></span><code>Defaults to [0, 0].
</code></pre></div>
<p>height:
    Float with the height of the adsorbate molecule from the surface in
    Angstrom.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>species_list, coordinates_list</code>
          </td>
          <td><p>Two lists of length equal to the number of nearest neighbors identified:
first with the list of species names, and second with the list of
coordinates.</p>
<p>Example:
(["Fe", "Sr"], [[0.4, 0.6], [0.2, 0.9]])</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>autocat/adsorption.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_adsorbate_slab_nn_list</span><span class="p">(</span>
    <span class="n">surface</span><span class="p">:</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">adsorption_site</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get list of nearest neighbors for the adsorbate on the surface at the</span>
<span class="sd">    specified position.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    surface (REQUIRED):</span>
<span class="sd">        Atoms object the surface for which nearest neighbors of the adsorbate</span>
<span class="sd">        should be identified.</span>

<span class="sd">    adsorption_site:</span>
<span class="sd">        Tuple or list of the xy cartesian coordinates for where the adsorbate</span>
<span class="sd">        would be placed.</span>

<span class="sd">        Defaults to [0, 0].</span>

<span class="sd">    height:</span>
<span class="sd">        Float with the height of the adsorbate molecule from the surface in</span>
<span class="sd">        Angstrom.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    species_list, coordinates_list:</span>
<span class="sd">        Two lists of length equal to the number of nearest neighbors identified:</span>
<span class="sd">        first with the list of species names, and second with the list of</span>
<span class="sd">        coordinates.</span>

<span class="sd">        Example:</span>
<span class="sd">        ([&quot;Fe&quot;, &quot;Sr&quot;], [[0.4, 0.6], [0.2, 0.9]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">adsorption_site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">adsorption_site</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">surf</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">conv</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span>
    <span class="n">add_adsorbate</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">adsorption_site</span><span class="p">)</span>
    <span class="n">init_guess</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span>
    <span class="n">nn</span> <span class="o">=</span> <span class="n">get_neighbors_of_site_with_index</span><span class="p">(</span><span class="n">init_guess</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_nn</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">hill_formula</span> <span class="k">for</span> <span class="n">_nn</span> <span class="ow">in</span> <span class="n">nn</span><span class="p">]</span>
    <span class="n">coord_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_nn</span><span class="o">.</span><span class="n">coords</span> <span class="k">for</span> <span class="n">_nn</span> <span class="ow">in</span> <span class="n">nn</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">species_list</span><span class="p">,</span> <span class="n">coord_list</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="autocat.adsorption.get_adsorption_sites" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_adsorption_sites</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">site_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>For the given surface, returns all symmetrically unique sites of the
specified type.</p>
<p>Uses <code>pymatgen.analysis.adsorption</code> module to identify the sites.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>surface</code></td>
          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p>Atoms object of the host surface for which the symmetrically unique
surface sites should be identified.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>site_types:
    List of types of adsorption sites to be searched for. Options are
    "ontop", "bridge", and "hollow".</p>
<div class="highlight"><pre><span></span><code>Defaults to [&quot;ontop&quot;, &quot;bridge&quot;, &quot;hollow&quot;].
</code></pre></div>
<p>**kwargs:
    Other miscellaneous keyword arguments. Will be passed on to
    <code>AdsorbateSiteFinder.find_adsorption_sites</code> in <code>pymatgen</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>sites</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Sequence">Sequence</span>[float]]</code>
          </td>
          <td><p>Dictionary containing the reference structures with the identified
sites for each desired site type</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>autocat/adsorption.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_adsorption_sites</span><span class="p">(</span>
    <span class="n">surface</span><span class="p">:</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">site_types</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the given surface, returns all symmetrically unique sites of the</span>
<span class="sd">    specified type.</span>

<span class="sd">    Uses `pymatgen.analysis.adsorption` module to identify the sites.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    surface (REQUIRED):</span>
<span class="sd">        Atoms object of the host surface for which the symmetrically unique</span>
<span class="sd">        surface sites should be identified.</span>

<span class="sd">    site_types:</span>
<span class="sd">        List of types of adsorption sites to be searched for. Options are</span>
<span class="sd">        &quot;ontop&quot;, &quot;bridge&quot;, and &quot;hollow&quot;.</span>

<span class="sd">        Defaults to [&quot;ontop&quot;, &quot;bridge&quot;, &quot;hollow&quot;].</span>

<span class="sd">    **kwargs:</span>
<span class="sd">        Other miscellaneous keyword arguments. Will be passed on to</span>
<span class="sd">        `AdsorbateSiteFinder.find_adsorption_sites` in `pymatgen`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    sites:</span>
<span class="sd">        Dictionary containing the reference structures with the identified</span>
<span class="sd">        sites for each desired site type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">site_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">site_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ontop&quot;</span><span class="p">,</span> <span class="s2">&quot;bridge&quot;</span><span class="p">,</span> <span class="s2">&quot;hollow&quot;</span><span class="p">]</span>

    <span class="n">converter</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span>
    <span class="n">pmg_structure</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span>
    <span class="n">finder</span> <span class="o">=</span> <span class="n">AdsorbateSiteFinder</span><span class="p">(</span><span class="n">pmg_structure</span><span class="p">)</span>
    <span class="n">sites</span> <span class="o">=</span> <span class="n">finder</span><span class="o">.</span><span class="n">find_adsorption_sites</span><span class="p">(</span><span class="n">positions</span><span class="o">=</span><span class="n">site_types</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Remove the extraneous &quot;all&quot; returned by default from pymatgen</span>
    <span class="n">sites</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sites</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="autocat.adsorption.place_adsorbate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">place_adsorbate</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorbate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adsorption_site</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor_atom_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Places an adsorbate molecule/intermediate onto a given surface at the specified location.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>surface</code></td>
          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p>Atoms object of the host surface.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>adsorbate (REQUIRED):
    Atoms object of the adsorbate molecule/intermediate to be placed on the
    host surface.</p>
<p>adsorption_site:
    Tuple or list of the xy cartesian coordinates on the surface where the
    adsorbate must be placed.</p>
<div class="highlight"><pre><span></span><code>Defaults to [0, 0].
</code></pre></div>
<p>rotations:
    List of rotation operations to be applied to the adsorbate
    molecule/intermediate before being placed on the host surface.</p>
<div class="highlight"><pre><span></span><code>Example:
Rotating 90 degrees around the z axis followed by 45 degrees
around the y-axis can be specified as
    [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)]

Defaults to [(0, &quot;x&quot;)] (i.e., no rotations applied).
</code></pre></div>
<p>anchor_atom_index:
    Integer index of the atom in the adsorbate molecule that will be used as
    anchor when placing it on the surface.
    Defaults to the atom at index 0.</p>
<p>height:
    Float specifying the height above surface where adsorbate should be placed.
    If None, will estimate initial height based on covalent radii of the
    nearest neighbor atoms.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>surface</code></td>          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p>Atoms object of the surface with the adsorbate molecule/intermediate
placed on it as specified.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>autocat/adsorption.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">place_adsorbate</span><span class="p">(</span>
    <span class="n">surface</span><span class="p">:</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adsorbate</span><span class="p">:</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adsorption_site</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rotations</span><span class="p">:</span> <span class="n">RotationOperations</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">anchor_atom_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Atoms</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Places an adsorbate molecule/intermediate onto a given surface at the specified location.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    surface (REQUIRED):</span>
<span class="sd">        Atoms object of the host surface.</span>

<span class="sd">    adsorbate (REQUIRED):</span>
<span class="sd">        Atoms object of the adsorbate molecule/intermediate to be placed on the</span>
<span class="sd">        host surface.</span>

<span class="sd">    adsorption_site:</span>
<span class="sd">        Tuple or list of the xy cartesian coordinates on the surface where the</span>
<span class="sd">        adsorbate must be placed.</span>

<span class="sd">        Defaults to [0, 0].</span>

<span class="sd">    rotations:</span>
<span class="sd">        List of rotation operations to be applied to the adsorbate</span>
<span class="sd">        molecule/intermediate before being placed on the host surface.</span>

<span class="sd">        Example:</span>
<span class="sd">        Rotating 90 degrees around the z axis followed by 45 degrees</span>
<span class="sd">        around the y-axis can be specified as</span>
<span class="sd">            [(90.0, &quot;z&quot;), (45.0, &quot;y&quot;)]</span>

<span class="sd">        Defaults to [(0, &quot;x&quot;)] (i.e., no rotations applied).</span>

<span class="sd">    anchor_atom_index:</span>
<span class="sd">        Integer index of the atom in the adsorbate molecule that will be used as</span>
<span class="sd">        anchor when placing it on the surface.</span>
<span class="sd">        Defaults to the atom at index 0.</span>

<span class="sd">    height:</span>
<span class="sd">        Float specifying the height above surface where adsorbate should be placed.</span>
<span class="sd">        If None, will estimate initial height based on covalent radii of the</span>
<span class="sd">        nearest neighbor atoms.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    surface:</span>
<span class="sd">        Atoms object of the surface with the adsorbate molecule/intermediate</span>
<span class="sd">        placed on it as specified.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">adsorption_site</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">adsorption_site</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">rotations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rotations</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)]</span>

    <span class="n">_surface</span> <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">_adsorbate</span> <span class="o">=</span> <span class="n">adsorbate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rotations</span><span class="p">:</span>
        <span class="n">_adsorbate</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">get_adsorbate_height_estimate</span><span class="p">(</span>
            <span class="n">_surface</span><span class="p">,</span>
            <span class="n">_adsorbate</span><span class="p">,</span>
            <span class="n">adsorption_site</span><span class="o">=</span><span class="n">adsorption_site</span><span class="p">,</span>
            <span class="n">anchor_atom_index</span><span class="o">=</span><span class="n">anchor_atom_index</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">add_adsorbate</span><span class="p">(</span>
        <span class="n">_surface</span><span class="p">,</span>
        <span class="n">_adsorbate</span><span class="p">,</span>
        <span class="n">height</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="n">adsorption_site</span><span class="p">,</span>
        <span class="n">mol_index</span><span class="o">=</span><span class="n">anchor_atom_index</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">_surface</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../surface/" class="md-footer__link md-footer__link--prev" aria-label="Previous: autocat.surface" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              autocat.surface
            </div>
          </div>
        </a>
      
      
        
        <a href="../saa/" class="md-footer__link md-footer__link--next" aria-label="Next: autocat.saa" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              autocat.saa
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>